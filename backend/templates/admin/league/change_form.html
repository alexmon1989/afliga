{% extends "admin/change_form.html" %}

{% block extrahead %}
    {{ block.super }}

    <script type="text/javascript" charset="utf-8">
        django.jQuery(function () {
            // Фильтрация игроков при смене команды
            django.jQuery(document).on('change', ".field-team select", function () {
                var $this = django.jQuery(this);
                var $playersSelect = $this.parent().parent().parent().find(".field-player select");

                $playersSelect.prop("disabled", "disabled");

                django.jQuery.getJSON("/league/get-players/" + $this.val(), function (data) {
                    var options = '<option value="">---------</option>';
                    for (var i = 0; i < data.length; i++) {
                        options += '<option value="' + data[i].id + '">' + data[i].name + '</option>';
                    }

                    $playersSelect.html(options);
                    $playersSelect.prop("disabled", false);
                });
            });
        });
    </script>
{% endblock %}